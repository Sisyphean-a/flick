import { Button, LineEdit } from "std-widgets.slint";
import { Style } from "../theme/style.slint";

export component PathBreadcrumb inherits Rectangle {
    in property <string> current-path: "/";
    callback navigate(string);
    callback go-up();
    in-out property <bool> editing: false;
    in-out property <string> edit-text: "";
    height: 32px;
    background: Style.bg-input;
    border-radius: 4px;
    border-width: 1px;
    border-color: Style.border-color;
    HorizontalLayout {
        padding-left: 8px;
        padding-right: 4px;
        spacing: 4px;
        Button {
            text: "上级";
            width: 40px;
            clicked => {
                root.go-up();
            }
        }

        if !root.editing: TouchArea {
            horizontal-stretch: 1;
            clicked => {
                root.edit-text = root.current-path;
                root.editing = true;
            }
            Text {
                text: root.current-path;
                vertical-alignment: center;
                overflow: elide;
                font-size: 13px;
            }
        }

        if root.editing: edit-input := LineEdit {
            horizontal-stretch: 1;
            text: root.edit-text;
            font-size: 13px;
            accepted(text) => {
                root.editing = false;
                if (text != "" && text != root.current-path) {
                    root.navigate(text);
                }
            }
        }

        if root.editing: Button {
            text: "取消";
            width: 40px;
            clicked => {
                root.editing = false;
            }
        }
    }
}
